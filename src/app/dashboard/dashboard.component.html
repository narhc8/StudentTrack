<!-- <div *ngFor="let list of lists">
    <h2>{{list.location}}</h2>
    <div id="{{list.location}}">
        <ul dragula="VAMPIRES">
            <li *ngFor="let item of list.value">
                {{ item.name }} <span style="display: none;">%%{{item.location}}</span>
            </li>
        </ul>
    </div>
</div> -->
<div>
    <div class="breadcrumb-bar navbar bg-white sticky-top">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a (click)="goBack()">Back</a>
                </li>
            </ol>
        </nav>

        <div class="dropdown">
            <button *ngIf="currentRole == 1 || currentRole == 2" class="btn btn-round" role="button"
                data-toggle="dropdown" aria-expanded="false">
                <svg class="bi bi-gear" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                        d="M8.837 1.626c-.246-.835-1.428-.835-1.674 0l-.094.319A1.873 1.873 0 014.377 3.06l-.292-.16c-.764-.415-1.6.42-1.184 1.185l.159.292a1.873 1.873 0 01-1.115 2.692l-.319.094c-.835.246-.835 1.428 0 1.674l.319.094a1.873 1.873 0 011.115 2.693l-.16.291c-.415.764.42 1.6 1.185 1.184l.292-.159a1.873 1.873 0 012.692 1.116l.094.318c.246.835 1.428.835 1.674 0l.094-.319a1.873 1.873 0 012.693-1.115l.291.16c.764.415 1.6-.42 1.184-1.185l-.159-.291a1.873 1.873 0 011.116-2.693l.318-.094c.835-.246.835-1.428 0-1.674l-.319-.094a1.873 1.873 0 01-1.115-2.692l.16-.292c.415-.764-.42-1.6-1.185-1.184l-.291.159A1.873 1.873 0 018.93 1.945l-.094-.319zm-2.633-.283c.527-1.79 3.065-1.79 3.592 0l.094.319a.873.873 0 001.255.52l.292-.16c1.64-.892 3.434.901 2.54 2.541l-.159.292a.873.873 0 00.52 1.255l.319.094c1.79.527 1.79 3.065 0 3.592l-.319.094a.873.873 0 00-.52 1.255l.16.292c.893 1.64-.902 3.434-2.541 2.54l-.292-.159a.873.873 0 00-1.255.52l-.094.319c-.527 1.79-3.065 1.79-3.592 0l-.094-.319a.873.873 0 00-1.255-.52l-.292.16c-1.64.893-3.433-.902-2.54-2.541l.159-.292a.873.873 0 00-.52-1.255l-.319-.094c-1.79-.527-1.79-3.065 0-3.592l.319-.094a.873.873 0 00.52-1.255l-.16-.292c-.892-1.64.902-3.433 2.541-2.54l.292.159a.873.873 0 001.255-.52l.094-.319z"
                        clip-rule="evenodd" />
                    <path fill-rule="evenodd"
                        d="M8 5.754a2.246 2.246 0 100 4.492 2.246 2.246 0 000-4.492zM4.754 8a3.246 3.246 0 116.492 0 3.246 3.246 0 01-6.492 0z"
                        clip-rule="evenodd" />
                </svg>
            </button>

            <button *ngIf="currentRole == 3" class="btn btn-round" aria-expanded="false" disabled>
                <svg class="bi bi-gear" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                        d="M8.837 1.626c-.246-.835-1.428-.835-1.674 0l-.094.319A1.873 1.873 0 014.377 3.06l-.292-.16c-.764-.415-1.6.42-1.184 1.185l.159.292a1.873 1.873 0 01-1.115 2.692l-.319.094c-.835.246-.835 1.428 0 1.674l.319.094a1.873 1.873 0 011.115 2.693l-.16.291c-.415.764.42 1.6 1.185 1.184l.292-.159a1.873 1.873 0 012.692 1.116l.094.318c.246.835 1.428.835 1.674 0l.094-.319a1.873 1.873 0 012.693-1.115l.291.16c.764.415 1.6-.42 1.184-1.185l-.159-.291a1.873 1.873 0 011.116-2.693l.318-.094c.835-.246.835-1.428 0-1.674l-.319-.094a1.873 1.873 0 01-1.115-2.692l.16-.292c.415-.764-.42-1.6-1.185-1.184l-.291.159A1.873 1.873 0 018.93 1.945l-.094-.319zm-2.633-.283c.527-1.79 3.065-1.79 3.592 0l.094.319a.873.873 0 001.255.52l.292-.16c1.64-.892 3.434.901 2.54 2.541l-.159.292a.873.873 0 00.52 1.255l.319.094c1.79.527 1.79 3.065 0 3.592l-.319.094a.873.873 0 00-.52 1.255l.16.292c.893 1.64-.902 3.434-2.541 2.54l-.292-.159a.873.873 0 00-1.255.52l-.094.319c-.527 1.79-3.065 1.79-3.592 0l-.094-.319a.873.873 0 00-1.255-.52l-.292.16c-1.64.893-3.433-.902-2.54-2.541l.159-.292a.873.873 0 00-.52-1.255l-.319-.094c-1.79-.527-1.79-3.065 0-3.592l.319-.094a.873.873 0 00.52-1.255l-.16-.292c-.892-1.64.902-3.433 2.541-2.54l.292.159a.873.873 0 001.255-.52l.094-.319z"
                        clip-rule="evenodd" />
                    <path fill-rule="evenodd"
                        d="M8 5.754a2.246 2.246 0 100 4.492 2.246 2.246 0 000-4.492zM4.754 8a3.246 3.246 0 116.492 0 3.246 3.246 0 01-6.492 0z"
                        clip-rule="evenodd" />
                </svg>
            </button>

            <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" (click)="setBoardData('none')" data-toggle="modal"
                    data-target="#projectEditModal">Edit Board</a>
                <a class="dropdown-item" (click)="setBoardData('collabs')" data-toggle="modal"
                    data-target="#addCollaborators">Add Collaborators</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item text-danger" (click)="deleteBoard()">Delete</a>
            </div>
        </div>
    </div>
    <div class="modal fade" id="projectEditModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Update Board</h5>
                    <button #closeModal type="button" class="close btn btn-round" data-dismiss="modal"
                        aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="input-group flex-nowrap">
                        <input #boardNewName type="text" class="form-control" aria-label="Board Name"
                            aria-describedby="addon-wrapping">
                    </div>
                    <div class="input-group flex-nowrap">
                        <input #boardNewDesc type="text" class="form-control" aria-label="Board Name"
                            aria-describedby="addon-wrapping">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">
                        Cancel
                    </button>

                    <button (click)="updateBoard(boardNewName.value, boardNewDesc.value)" type="button"
                        class="btn btn-primary">
                        Update Board
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addCollaborators" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Add Collaborators</h5>
                    <button #closeCollabModal type="button" class="close btn btn-round" data-dismiss="modal"
                        aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h6 class="modal-title">Enter the username of the user and role you wish to add as a collaborators
                    </h6>
                    <div class="input-group flex-nowrap">
                        <div class="input-group flex-nowrap">
                            <input #usernameData type="text" class="form-control" placeholder="Username"
                                aria-label="Username" aria-describedby="addon-wrapping">
                        </div>
                    </div>
                    <div class="input-group flex-nowrap">
                        <form>
                            <div class="form-group">
                                <label for="exampleFormControlSelect1">Collaborators Role</label>
                                <select #exampleFormControlSelect1 class="form-control" id="exampleFormControlSelect1">
                                    <option>Editor</option>
                                    <option>Viewer</option>
                                </select>
                            </div>
                        </form>
                    </div>
                    <h6>Current Collaborators:</h6>
                    <div class="input-group flex-nowrap">
                        <ul class="list-group" style="width: 80%;">
                            <li *ngFor="let c of collabs"
                                class="list-group-item d-flex justify-content-between align-items-center">
                                {{c.name}}({{c.role_name}}) <span *ngIf="c.user_id == userId"> You</span>
                                <button *ngIf="c.user_id == userId" type="button" class="btn btn-primary"
                                    disabled>Remove</button>
                                <button *ngIf="c.user_id != userId" type="button" class="btn btn-primary"
                                    (click)="removeCollab(c)">Remove</button>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">
                        Cancel
                    </button>

                    <button (click)="addCollab(usernameData.value, exampleFormControlSelect1.value)" type="button"
                        class="btn btn-primary">
                        Add Collaborators
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-11 col-xl-10">
                <div class="page-header">
                    <h1>{{boardName}}</h1>
                    <p *ngIf="boardDesc.length != 0" class="lead">{{boardDesc}}</p>
                    <p *ngIf="boardDesc.length == 0" class="lead">No description available</p>
                </div>
                <hr>
            </div>
        </div>
        <div *ngIf="currentRole == 1 || currentRole == 2" class="kanban-board container-fluid mt-lg-3" tabindex="0">
            <div *ngFor="let list of lists" class="kanban-col" tabindex="0">
                <div class="card-list">
                    <div class="card-list-header">
                        <h6 #listColval>{{list.list_name}}</h6>
                        <div class="dropdown">
                            <button (click)="setListName(list.list_name, list.list_id)" class="btn-options"
                                type="button" data-toggle="modal" data-target="#editList" id="dropdownMenuButton"
                                aria-haspopup="true" aria-expanded="false">
                                <svg class="bi bi-three-dots-vertical" width="1em" height="1em" viewBox="0 0 16 16"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M9.5 13a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm0-5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm0-5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"
                                        clip-rule="evenodd" />
                                </svg>
                            </button>
                            <div class="modal fade" id="editList" tabindex="-1" role="dialog"
                                aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLabel">Update List</h5>
                                            <button #closeModal type="button" class="close btn btn-round"
                                                data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="input-group flex-nowrap">
                                                <input #listValue type="text" class="form-control"
                                                    aria-label="Board Name" aria-describedby="addon-wrapping">
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">
                                                Cancel
                                            </button>
                                            <button (click)="deleteList()" type="button" class="btn btn-danger">
                                                Delete List
                                            </button>
                                            <button (click)="updateListName(listValue.value)" type="button"
                                                class="btn btn-primary">
                                                Update List
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="{{list.list_id}}" class="card-list-body" tabindex="0">
                        <div dragula="VAMPIRES">
                            <div *ngFor="let item of list.value" (click)="setCardData(item)" data-toggle="modal"
                                data-target="#openTask" class="card card-kanban" tabindex="0">
                                <div class="card-body">
                                    <div class="card-title">
                                        <a href="#" data-toggle="modal" data-target="#task-modal">
                                            <h6>{{item.task_name}}<span style="display: none;">%%{{item.task_id}}</span>
                                            </h6>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="card card-kanban doNotMoveClass" tabindex="0" style="display: contents;">
                                <div class="card-body">
                                    <div class="card-title">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="openTask" tabindex="-1" role="dialog"
                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Task</h5>
                                <button #closeDeleteTaskModal type="button" class="close btn btn-round"
                                    data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div *ngIf="currentViewing" class="modal-body">
                                <div class="input-group flex-nowrap">
                                    <h3>{{currentTaskName}}</h3>
                                </div>
                                <div class="input-group flex-nowrap">
                                    <h5>{{currentTaskDesc}}</h5>
                                </div>
                            </div>
                            <div *ngIf="!currentViewing" class="modal-body">
                                <div class="input-group flex-nowrap">
                                    <input #taskUpdateName type="text" class="form-control"
                                        [value]="currentTaskName" [placeholder]="currentTaskName" aria-label="Board Name" aria-describedby="addon-wrapping">
                                </div>
                                <div class="input-group flex-nowrap">
                                    <input #taskUpdateDesc type="text" class="form-control"
                                        [value]="currentTaskDesc" [placeholder]="currentTaskDesc" aria-label="Board Name"
                                        aria-describedby="addon-wrapping">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button *ngIf="currentViewing" (click)="updateView(currentViewing)" type="button"
                                    class="btn btn-primary">
                                    Update Task
                                </button>
                                <button *ngIf="!currentViewing" (click)="updateTask()" type="button"
                                    class="btn btn-primary">
                                    Update Task
                                </button>
                                <button (click)="deleteTask(currentTaskId)" type="button" class="btn btn-danger">
                                    Delete Task
                                </button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                    <div class="card-list-footer">
                        <button (click)="setListName(list.list_name, list.list_id)" data-toggle="modal"
                            data-target="#addTask" class="btn btn-link btn-sm text-small">Add
                            task</button>
                    </div>
                    <div class="modal fade" id="addTask" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Add Task</h5>
                                    <button #closeAddTaskModal type="button" class="close btn btn-round"
                                        data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="input-group flex-nowrap">
                                        <input #taskNewName type="text" class="form-control" placeholder="Task name"
                                            aria-label="Board Name" aria-describedby="addon-wrapping">
                                    </div>
                                    <div class="input-group flex-nowrap">
                                        <input #taskNewDesc type="text" class="form-control"
                                            placeholder="Task description" aria-label="Board Name"
                                            aria-describedby="addon-wrapping">
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">
                                        Cancel
                                    </button>
                                    <button (click)="addNewTask(taskNewName.value, taskNewDesc.value)" type="button"
                                        class="btn btn-primary">
                                        Add Task
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="kanban-col">
                <div class="card-list">
                    <button data-toggle="modal" data-target="#addList" class="btn btn-link btn-sm text-small">Add
                        list
                    </button>
                    <div class="modal fade" id="addList" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Add List</h5>
                                    <button #closeAddListModal type="button" class="close btn btn-round"
                                        data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="input-group flex-nowrap">
                                        <input #listNameInput type="text" placeholder="New List name"
                                            class="form-control" aria-label="Board Name"
                                            aria-describedby="addon-wrapping">
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">
                                        Cancel
                                    </button>
                                    <button (click)="addNewList(listNameInput.value)" type="button"
                                        class="btn btn-primary">
                                        Add List
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="currentRole == 3" class="kanban-board container-fluid mt-lg-3" tabindex="0">
            <div *ngFor="let list of lists" class="kanban-col" tabindex="0">
                <div class="card-list">
                    <div class="card-list-header">
                        <h6 #listColval>{{list.list_name}}</h6>
                    </div>
                    <div id="{{list.list_id}}" class="card-list-body" tabindex="0">
                        <div *ngFor="let item of list.value" class="card card-kanban" tabindex="0">
                            <div class="card-body">
                                <div class="card-title">
                                    <a href="#" data-toggle="modal" data-target="#task-modal">
                                        <h6>{{item.task_name}}<span style="display: none;">%%{{item.task_id}}</span>
                                        </h6>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>